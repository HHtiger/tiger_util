(1)
Win + R, 输入regedit, 回车，启动注册表编辑程序，找到HKEY_CLASSES_ROOT\Directory\Background\shell表项

(2)
右击"shell"->新建->项，输入新建项的名字，如"在此处打开Cygwin窗口"，此名随便起，会显示在菜单项上。
右击刚才新建的项->新建->项，输入新建项名字为"command"，这个项的名字必须为"command"，表示点击该菜单项时要执行的命令。
双击"command"下"(默认)"数据项，在"数值数据(V)"下输入如下内容：

"D:\Cygwin\bin\mintty.exe" -i /Cygwin-Terminal.ico /bin/env _T=%V /bin/bash -l
解释下上面一行内容的含义。
"D:\Cygwin\bin\mintty.exe"为mintty所在位置，注意根据cygwin安装路径不同有所不同。
-i 用于指定mintty窗口左上角的图标，
/bin/env _T=%V 用于设置在启动mintty后的shell里面，
_T 为路径参数，其中%V表示windows传入的路径参数。
/bin/bash -l 表示启动登录shell

(3)
若仅进行以上设置，右击即可出现菜单项。现在要将其设置成Shift+右击才出现。
找到新建的”在此处打开Cygwin窗口“，右击->新建->字符串值,名字输入”Extended“，值保持默认即可。

(4)
进入Cygwin，编辑~/.bash_profile文件，在尾部添加如下内容：
_T=${_T//\\//} #将所有的'\'替换为'/'
if [[ $_T == "" ]]; then
    _T=${HOME}
fi
cd "${_T}"